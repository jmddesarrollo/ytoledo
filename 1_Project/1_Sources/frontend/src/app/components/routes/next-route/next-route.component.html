<div class="route-detail-container">
  <!-- Header -->
  <div class="w3-row w3-margin-bottom">
    <div class="w3-col l8 m8 s12">
      <h2>{{ nextRoute?.name || 'Próxima Ruta' }}</h2>
    </div>
    <div class="w3-col l4 m4 s12 w3-right-align">
      <button class="w3-button w3-light-grey w3-round" (click)="loadNextRoute()">
        <i class="fa fa-refresh"></i> Actualizar
      </button>
    </div>
  </div>

  <!-- Loading indicator -->
  <div *ngIf="loading" class="w3-center w3-padding">
    <i class="fa fa-spinner fa-spin fa-2x"></i>
    <p>Cargando próxima ruta...</p>
  </div>

  <!-- Error message -->
  <div *ngIf="errorMessage" class="w3-panel w3-red w3-round w3-margin-bottom">
    <p><i class="fa fa-exclamation-triangle"></i> {{ errorMessage }}</p>
  </div>

  <!-- Next route details -->
  <div *ngIf="nextRoute && !loading" class="route-details">
    
    <!-- Información básica -->
    <div class="w3-card w3-white w3-margin-bottom">
      <div class="w3-container w3-padding">
        <h4 class="section-title">
          <i class="fa fa-info-circle"></i> Información Básica
        </h4>
        
        <div class="w3-row-padding">
          <div class="w3-col l6 m6 s12">
            <div class="detail-item">
              <label class="detail-label">Fecha:</label>
              <span class="detail-value">{{ formatDate(nextRoute.date) }}</span>
            </div>
            
            <div class="detail-item">
              <label class="detail-label">Punto de Inicio:</label>
              <span class="detail-value">{{ getStartPoint() }}</span>
            </div>
            
            <div class="detail-item">
              <label class="detail-label">Tipo de Ruta:</label>
              <span class="detail-value">{{ getRouteTypeLabel(nextRoute.type) }}</span>
            </div>
          </div>
          
          <div class="w3-col l6 m6 s12">
            <div class="detail-item">
              <label class="detail-label">Dificultad:</label>
              <span class="w3-tag w3-round detail-tag" [ngClass]="getDifficultyClass(nextRoute.difficulty)">
                {{ nextRoute.difficulty || 'No especificada' }}
              </span>
            </div>
            
            <div class="detail-item">
              <label class="detail-label">Distancia:</label>
              <span class="detail-value">{{ formatDistance(getDistanceKm()) }}</span>
            </div>
            
            <div class="detail-item">
              <label class="detail-label">Duración Estimada:</label>
              <span class="detail-value">{{ formatDuration() }}</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Descripción -->
    <div *ngIf="nextRoute.description" class="w3-card w3-white w3-margin-bottom">
      <div class="w3-container w3-padding">
        <h4 class="section-title">
          <i class="fa fa-file-text-o"></i> Descripción
        </h4>
        
        <div class="description-content">
          {{ nextRoute.description }}
        </div>
      </div>
    </div>

    <!-- Características técnicas -->
    <div class="w3-card w3-white w3-margin-bottom">
      <div class="w3-container w3-padding">
        <h4 class="section-title">
          <i class="fa fa-mountain"></i> Características Técnicas
        </h4>
        
        <div class="w3-row-padding">
          <div class="w3-col l3 m6 s12">
            <div class="stat-card">
              <div class="stat-icon">
                <i class="fa fa-arrows-h"></i>
              </div>
              <div class="stat-content">
                <div class="stat-value">{{ getDistanceKm() || '0' }}</div>
                <div class="stat-label">Kilómetros</div>
              </div>
            </div>
          </div>
          
          <div class="w3-col l3 m6 s12">
            <div class="stat-card">
              <div class="stat-icon">
                <i class="fa fa-arrow-up"></i>
              </div>
              <div class="stat-content">
                <div class="stat-value">{{ getElevationGain() || '0' }}</div>
                <div class="stat-label">Desnivel (+)</div>
              </div>
            </div>
          </div>
          
          <div class="w3-col l3 m6 s12">
            <div class="stat-card">
              <div class="stat-icon">
                <i class="fa fa-chevron-up"></i>
              </div>
              <div class="stat-content">
                <div class="stat-value">{{ getMaxHeight() || '0' }}</div>
                <div class="stat-label">Altura Máx (m)</div>
              </div>
            </div>
          </div>
          
          <div class="w3-col l3 m6 s12">
            <div class="stat-card">
              <div class="stat-icon">
                <i class="fa fa-chevron-down"></i>
              </div>
              <div class="stat-content">
                <div class="stat-value">{{ getMinHeight() || '0' }}</div>
                <div class="stat-label">Altura Mín (m)</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Mapa de Wikiloc embebido -->
    <div *ngIf="hasWikilocMapLink() || getWikilocLink()" class="w3-card w3-white w3-margin-bottom">
      <div class="w3-container w3-padding">
        <h4 class="section-title">
          <i class="fa fa-map"></i> Mapa de la Ruta
        </h4>
        
        <!-- Iframe del mapa si existe -->
        <div *ngIf="hasWikilocMapLink()" class="wikiloc-map-container">
          <div [innerHTML]="getWikilocMapLink()"></div>
        </div>
        
        <!-- Botón centrado para ver en Wikiloc -->
        <div *ngIf="getWikilocLink()" class="w3-center" [ngClass]="{'w3-margin-top': hasWikilocMapLink()}">
          <button class="w3-button w3-blue w3-round w3-large" (click)="openLink(getWikilocLink())">
            <i class="fa fa-map-marker"></i> Ver en Wikiloc
          </button>
        </div>
      </div>
    </div>

    <!-- Call to Action especial para próxima ruta -->
    <div class="w3-card w3-green w3-margin-bottom">
      <div class="w3-container w3-padding">
        <h4 class="section-title w3-text-white">
          <i class="fa fa-calendar-check-o"></i> ¡Próxima Aventura!
        </h4>
        <div class="w3-row-padding">
          <div class="w3-col l8 m8 s12">
            <p class="w3-text-white w3-large">
              Esta es nuestra próxima ruta programada. ¡No te la pierdas!
            </p>
            <p class="w3-text-white">
              Únete a nosotros para disfrutar de una increíble experiencia en la naturaleza.
            </p>
          </div>
          <div class="w3-col l4 m4 s12 w3-center">
            <div *ngIf="getSignUpLink()" class="w3-margin-top">
              <button class="w3-button w3-white w3-text-green w3-large w3-round w3-hover-shadow" 
                      (click)="openLink(getSignUpLink())">
                <i class="fa fa-user-plus"></i> ¡Inscríbete Ya!
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

  </div>

  <!-- No route available -->
  <div *ngIf="!loading && !errorMessage && !nextRoute" class="w3-center w3-padding-64">
    <div class="w3-panel w3-pale-yellow w3-border w3-round w3-margin-bottom">
      <h3><i class="fa fa-calendar-times-o"></i> No hay rutas programadas</h3>
      <p class="w3-large">Actualmente no hay ninguna ruta programada próximamente.</p>
      <p>¡Mantente atento a nuestras actualizaciones!</p>
    </div>
  </div>
</div>